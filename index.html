<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Attendance Verification</title>
  <script>
    function verifyLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(success, error);
      } else {
        alert("‚ùå GPS not supported.");
      }
    }

    function success(position) {
      const lat = position.coords.latitude;
      const lon = position.coords.longitude;

       // üéØ Replace with your classroom coordinates
      const schoolLat = 2.8324327083435725;  
      const schoolLon = 101.70653606993983;  
      const allowedRadius = 0.1; // km

      const dist = distance(lat, lon, schoolLat, schoolLon);

      if (dist <= allowedRadius) {
        // ‚úÖ GPS ok ‚Üí go to loadForm.php
        window.location.href = "loadForm.php?gpsok=1";
      } else {
        alert("‚ùå You are not in the classroom area.");
      }
    }

    function error(err) {
      alert("‚ùå GPS error: " + err.message);
    }

    function distance(lat1, lon1, lat2, lon2) {
      function toRad(x) { return x * Math.PI / 180; }
      const R = 6371;
      const dLat = toRad(lat2 - lat1);
      const dLon = toRad(lon2 - lon1);
      const a = Math.sin(dLat/2) * Math.sin(dLat/2) +
                Math.cos(toRad(lat1)) * Math.cos(toRad(lat2)) *
                Math.sin(dLon/2) * Math.sin(dLon/2);
      return R * 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    }
  </script>
</head>
<body onload="verifyLocation()">
  <h2>Checking location‚Ä¶</h2>
</body>
</html>
